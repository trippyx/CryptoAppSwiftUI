//
//  MarketDataModal.swift
//  CryptoApp
//
//  Created by Kuldeep Singh on 01/02/24.
//

import Foundation



/*
 https://api.coingecko.com/api/v3/global
 {
   "data": {
     "active_cryptocurrencies": 12545,
     "upcoming_icos": 0,
     "ongoing_icos": 49,
     "ended_icos": 3376,
     "markets": 985,
     "total_market_cap": {
       "btc": 40247505.544203244,
       "eth": 746126465.6378788,
       "ltc": 25573685691.519344,
       "bch": 7197599843.81123,
       "bnb": 5663785570.674053,
       "eos": 2450927829311.1963,
       "xrp": 3427720660625.476,
       "xlm": 15592813100199.469,
       "link": 107134674242.58617,
       "dot": 254381209996.77298,
       "yfi": 237359908.8035147,
       "usd": 1690631656616.0974,
       "aed": 6209690074750.937,
       "ars": 1397060147439754,
       "aud": 2571996823738.17,
       "bdt": 185215840901042.44,
       "bhd": 637303890541.3176,
       "bmd": 1690631656616.0974,
       "brl": 8374543911047.832,
       "cad": 2270433783252.586,
       "chf": 1458232357202.6765,
       "clp": 1572714634531857.5,
       "cny": 12005851646293.541,
       "czk": 38825017867857.31,
       "dkk": 11660117472515.564,
       "eur": 1564199458807.7195,
       "gbp": 1333306512200.3462,
       "gel": 4522439681448.049,
       "hkd": 13215887441883.373,
       "huf": 600816678128226.1,
       "idr": 26654127305318936,
       "ils": 6153222977419.943,
       "inr": 140440499523402.36,
       "jpy": 248384644384637.62,
       "krw": 2252618378541395.5,
       "kwd": 519931787780.74554,
       "lkr": 533309950502188.44,
       "mmk": 3543973002287288.5,
       "mxn": 29092389547049.793,
       "myr": 7995842419965.819,
       "ngn": 1608484593083363.5,
       "nok": 17781040932135.863,
       "nzd": 2761569042026.186,
       "php": 95163123384698.33,
       "pkr": 472194897614312.06,
       "pln": 6772078695324.253,
       "rub": 152035221672808.3,
       "sar": 6340093566320.705,
       "sek": 17590620016756.215,
       "sgd": 2265233400276.837,
       "thb": 60034330126437.6,
       "try": 51335862880613.78,
       "twd": 52881433269197.14,
       "uah": 63352661366883.96,
       "vef": 169282947776.96964,
       "vnd": 41294425909914024,
       "zar": 31577279955944.11,
       "xdr": 1267221411374.8787,
       "xag": 73664912607.37233,
       "xau": 828358792.7921872,
       "bits": 40247505544203.24,
       "sats": 4024750554420324.5
     },
     "total_volume": {
       "btc": 1711036.728873017,
       "eth": 31719972.94809975,
       "ltc": 1087210621.3585262,
       "bch": 305990583.1670966,
       "bnb": 240783745.5973738,
       "eos": 104195961440.70778,
       "xrp": 145722222218.36023,
       "xlm": 662895142447.8098,
       "link": 4554601833.98404,
       "dot": 10814473780.532898,
       "yfi": 10090849.518082932,
       "usd": 71873593663.7994,
       "aed": 263991709527.13562,
       "ars": 59393028024775.52,
       "aud": 109342951133.39223,
       "bdt": 7874055851802.442,
       "bhd": 27093613614.69316,
       "bmd": 71873593663.7994,
       "brl": 356025846213.63,
       "cad": 96522642610.7993,
       "chf": 61993633857.99243,
       "clp": 66860603342601.1,
       "cny": 510403138044.1044,
       "czk": 1650562703770.4185,
       "dkk": 495704988139.8581,
       "eur": 66498598835.24583,
       "gbp": 56682678401.39343,
       "gel": 192261863050.66287,
       "hkd": 561845225237.0952,
       "huf": 25542437716240.918,
       "idr": 1133143288728024.8,
       "ils": 261591131498.76404,
       "inr": 5970527854003.2295,
       "jpy": 10559542602296.48,
       "krw": 95765258733502.72,
       "kwd": 22103789374.583904,
       "lkr": 22672533386708.79,
       "mmk": 150664442207184,
       "mxn": 1236800799766.6594,
       "myr": 339926161232.93866,
       "ngn": 68381286725194.17,
       "nok": 755922974631.6755,
       "nzd": 117402209064.50757,
       "php": 4045656920691.951,
       "pkr": 20074357455946.434,
       "pln": 287900460459.3973,
       "rub": 6463452699666.577,
       "sar": 269535535427.2054,
       "sek": 747827636156.5404,
       "sgd": 96301559436.68954,
       "thb": 2552231311001.5156,
       "try": 2182434556115.4954,
       "twd": 2248141179822.1553,
       "uah": 2693303075678.575,
       "vef": 7196702933.556224,
       "vnd": 1755544311981961.2,
       "zar": 1342440607733.7107,
       "xdr": 53873211498.66914,
       "xag": 3131706410.0284038,
       "xau": 35215904.6874517,
       "bits": 1711036728873.017,
       "sats": 171103672887301.7
     },
     "market_cap_percentage": {
       "btc": 48.73576281899771,
       "eth": 16.10693660001385,
       "usdt": 5.678720599399266,
       "bnb": 2.716339959729853,
       "sol": 2.444997092227653,
       "xrp": 1.5853987540611112,
       "usdc": 1.5834102669210932,
       "steth": 1.262927538060411,
       "ada": 1.0117322201754422,
       "avax": 0.7147708788242451
     },
     "market_cap_change_percentage_24h_usd": -1.368698350182221,
     "updated_at": 1706793766
   }
 }
 
 
 
 
 
 */


struct GlobalData : Codable{
    let data: MarketDataModal?
}


struct MarketDataModal : Codable{
    let totalMarketCap, totalVolume, marketCapPercentage: [String: Double]
    let marketCapChangePercentage24HUsd: Double
    
    enum CodingKeys : String,CodingKey{
        case totalMarketCap = "total_market_cap"
        case totalVolume = "total_volume"
        case marketCapPercentage = "market_cap_percentage"
        case marketCapChangePercentage24HUsd = "market_cap_change_percentage_24h_usd"
    }
    
    var marketCap:String{
        if let item = totalMarketCap.first(where: { $0.key == "usd" }){
            return "$" + item.value.formattedWithAbbreviations()
        }
        return ""
    }
    
    var volume:String{
        if let item = totalVolume.first(where: { $0.key == "usd" }){
            return "$"+item.value.formattedWithAbbreviations()
        }
        return ""
    }
    
    var btcDominace:String{
        if let item = marketCapPercentage.first(where: {$0.key == "btc"}){
            return item.value.asPercantageString()
        }
        return " "
    }
    
    
}


